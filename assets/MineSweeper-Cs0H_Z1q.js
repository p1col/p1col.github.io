import{d as U,e as x,b as X,c as v,a as r,w as h,i as y,g as f,F as M,f as C,o as d,n as z,j as F,t as D}from"./index-DAZ9M8Tn.js";const G={class:"mine-config"},I=r("label",{for:"row",class:"mine-config__label"},"行：",-1),P=r("label",{for:"col",class:"mine-config__label"},"列：",-1),q=r("label",{for:"count",class:"mine-config__label"},"雷数量：",-1),A=["max"],L={class:"mine-map"},N=["onClick","onContextmenu"],K=U({__name:"MineSweeper",setup(T){let g=x(!1),t=x({x:16,y:16,mines:20}),O=X(()=>t.value.x*t.value.y),c=new Set,s=x([]);const b=e=>Math.floor(Math.random()*e),w=e=>e-1<0?e:e-1,V=(e,n)=>e+1===n?e:e+1;function _(e){if(e<=0)return;const n=b(t.value.x),i=b(t.value.y);c.has("".concat(n,"-").concat(i))?_(e):(c.add("".concat(n,"-").concat(i)),_(e-1))}function k(e,n,i){if(e===0&&n===0)return 0;let a=w(e),l=w(n),u=V(n,t.value.y),o=0;for(;a<=e;){let m=l;for(;a<e&&m<=u||m<n;)!i&&s.value[a][m].isMine&&o++,i&&!s.value[a][m].isMine&&s.value[a][m].mines++,m++;a++}return o}function E(){for(let e=0;e<t.value.x;e++)for(let n=0;n<t.value.y;n++){const i=c.has("".concat(e,"-").concat(n));s.value[e]||(s.value[e]=[]),s.value[e][n]={x:e,y:n,isMine:i,isFlag:!1,isOpen:!1,mines:k(e,n,i)}}}function $(){s.value&&(s.value.length=0,s.value=new Array(t.value.x)),c.size>0&&c.clear(),_(t.value.mines),E(),g.value=!1}function B(){s.value.forEach(e=>e.forEach(n=>n.isOpen=!0))}let p=[];const R=[[-1,0],[0,1],[1,0],[0,-1]];function Y(e,n){for(p.push({x:e,y:n});p.length>0;){const{x:i,y:a}=p[0];if(s.value[i][a].isOpen=!0,s.value[i][a].isVisit=!0,p.shift(),s.value[i][a].mines===0)for(const l of R){let u=i+l[0],o=a+l[1];(u>=0&&u<t.value.x&&o>=0&&o<t.value.y?!(s.value[u][o].isOpen||s.value[u][o].isVisit||s.value[u][o].isFlag):!1)&&(s.value[u][o].isVisit=!0,p.push({x:u,y:o}))}}}function j(e){e.isFlag||e.isOpen||g.value||(e.isOpen=!0,e.isMine?(g.value=!0,e.isExplode=!0,B()):e.mines===0&&Y(e.x,e.y))}function S(e){if(!g.value)return e.isFlag=!e.isFlag,!1}return $(),(e,n)=>(d(),v(M,null,[r("div",G,[I,h(r("input",{id:"row",class:"mine-config__input",type:"number","onUpdate:modelValue":n[0]||(n[0]=i=>f(t).x=i)},null,512),[[y,f(t).x]]),P,h(r("input",{id:"col",class:"mine-config__input",type:"number","onUpdate:modelValue":n[1]||(n[1]=i=>f(t).y=i)},null,512),[[y,f(t).y]]),q,h(r("input",{id:"count",type:"number",class:"mine-config__input","onUpdate:modelValue":n[2]||(n[2]=i=>f(t).mines=i),max:f(O)},null,8,A),[[y,f(t).mines]]),r("button",{class:"mine-config__btn",onClick:$},"Play")]),r("div",L,[(d(!0),v(M,null,C(f(s),(i,a)=>(d(),v("div",{class:"mine-row",key:"row-".concat(a)},[(d(!0),v(M,null,C(i,(l,u)=>(d(),v("div",{class:z(["mine-cell",["color-".concat(l.mines),{"is-mine":l.isMine,"mine-cell--flag":l.isFlag,"mine-cell--open":l.isOpen,"mine-cell--explode":l.isExplode}]]),key:"cell-".concat(a,"-").concat(u),onClick:F(o=>j(l),["left"]),onContextmenu:F(o=>S(l),["prevent"])},D(l.mines||""),43,N))),128))]))),128))])],64))}});export{K as default};
