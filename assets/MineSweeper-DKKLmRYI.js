import{d as G,r as d,j as k,m as I,c as g,a as v,w as b,v as w,h as r,t as V,F as $,k as E,o as _,n as P,q as B}from"./index-ySh8VXTW.js";const A={class:"mine-config"},L=v("label",{for:"row",class:"mine-config__label"},"行：",-1),N=v("label",{for:"col",class:"mine-config__label"},"列：",-1),T=v("label",{for:"count",class:"mine-config__label"},"雷数量：",-1),H=["max"],J={class:"game-status"},K={class:"mine-map"},Q=["onClick","onContextmenu"],ne=G({__name:"MineSweeper",setup(W){let c=d(!1),i=d({x:16,y:16,mines:40}),R=k(()=>i.value.x*i.value.y),m=new Set,a=d([]),x=d(i.value.mines),h=d(i.value.x*i.value.y),y=k(()=>!c.value&&h.value===i.value.mines);const F=e=>Math.floor(Math.random()*e),C=e=>e-1<0?e:e-1,Y=(e,n)=>e+1===n?e:e+1;function M(e){if(e<=0)return;const n=F(i.value.x),s=F(i.value.y);m.has("".concat(n,"-").concat(s))?M(e):(m.add("".concat(n,"-").concat(s)),M(e-1))}function j(e,n,s){if(e===0&&n===0)return 0;let t=C(e),l=C(n),o=Y(n,i.value.y),u=0;for(;t<=e;){let f=l;for(;t<e&&f<=o||f<n;)!s&&a.value[t][f].isMine&&u++,s&&!a.value[t][f].isMine&&a.value[t][f].mines++,f++;t++}return u}function S(){for(let e=0;e<i.value.x;e++)for(let n=0;n<i.value.y;n++){const s=m.has("".concat(e,"-").concat(n));a.value[e]||(a.value[e]=[]),a.value[e][n]={x:e,y:n,isMine:s,isFlag:!1,isOpen:!1,mines:j(e,n,s)}}}function O(){a.value&&(a.value.length=0,a.value=new Array(i.value.x)),m.size>0&&m.clear(),x.value=i.value.mines,h.value=i.value.x*i.value.y,M(i.value.mines),S(),c.value=!1}function U(){a.value.forEach(e=>e.forEach(n=>n.isOpen=!0))}I(()=>y.value,e=>{if(e&&x.value>0)for(const n of m){const[s,t]=n.split("-");a.value[+s][+t].isFlag=!0}});let p=[];const X=[[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1]];function q(e,n){for(p.push({x:e,y:n});p.length>0;){const{x:s,y:t}=p[0];if(a.value[s][t].isOpen=!0,h.value--,a.value[s][t].isVisit=!0,p.shift(),a.value[s][t].mines===0)for(const l of X){let o=s+l[0],u=t+l[1];(o>=0&&o<i.value.x&&u>=0&&u<i.value.y?!(a.value[o][u].isOpen||a.value[o][u].isVisit||a.value[o][u].isFlag):!1)&&(a.value[o][u].isVisit=!0,p.push({x:o,y:u}))}}}function z(e){e.isFlag||e.isOpen||c.value||y.value||(e.isOpen=!0,e.isMine?(c.value=!0,e.isExplode=!0,U()):e.mines===0?q(e.x,e.y):h.value--)}function D(e){if(!(c.value||y.value))return e.isFlag=!e.isFlag,x.value+=e.isFlag?1:-1,!1}return O(),(e,n)=>(_(),g($,null,[v("div",A,[L,b(v("input",{id:"row",class:"mine-config__input",type:"number","onUpdate:modelValue":n[0]||(n[0]=s=>r(i).x=s)},null,512),[[w,r(i).x]]),N,b(v("input",{id:"col",class:"mine-config__input",type:"number","onUpdate:modelValue":n[1]||(n[1]=s=>r(i).y=s)},null,512),[[w,r(i).y]]),T,b(v("input",{id:"count",type:"number",class:"mine-config__input","onUpdate:modelValue":n[2]||(n[2]=s=>r(i).mines=s),max:r(R)},null,8,H),[[w,r(i).mines]]),v("button",{class:"mine-config__btn",onClick:O},"Play")]),v("div",J,V(r(y)?"ψ(｀∇´)ψ 通关！":"ψ(._. )> 剩余标记数：".concat(r(x))),1),v("div",K,[(_(!0),g($,null,E(r(a),(s,t)=>(_(),g("div",{class:"mine-row",key:"row-".concat(t)},[(_(!0),g($,null,E(s,(l,o)=>(_(),g("div",{class:P(["mine-cell",["color-".concat(l.mines),{"is-mine":l.isMine,"mine-cell--flag":l.isFlag,"mine-cell--open":l.isOpen,"mine-cell--explode":l.isExplode}]]),key:"cell-".concat(t,"-").concat(o),onClick:B(u=>z(l),["left"]),onContextmenu:B(u=>D(l),["prevent"])},V(l.mines||""),43,Q))),128))]))),128))])],64))}});export{ne as default};
